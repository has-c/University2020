---
title: "Stats 326 Assignment 1"
author: 'Name: Hasnain Cheena, ID:190411106'
output:
  word_document: default
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Read in data
```{r data}
aud.df = read.csv("Data\\NZD To AUD.csv")
sunspot.df = read.csv("Data\\Monthly Sunspot.csv")
xrp.df = read.csv("Data\\XRP Daily Price.csv")
temp.df = read.csv("Data\\GlobalLandTemperaturesByMajorCity.csv")
milkprod.df = read.csv("Data\\Milk Production.csv", nrows=58)
milkprodLong.df = read.csv("Data\\2002 NZ Milk production data.csv")
alc.df = read.csv("Data\\NZAlcoholConsumption.csv")
vis.df = read.csv("Data\\NZVisitorsPurpose.csv")
```

## Question 1 - Find a Time Series that exhibits cycles
Found from: https://www.ofx.com/en-us/forex-news/historical-exchange-rates/monthly-average-rates/
```{r NZD AUD rate}
#plot time vs exchange rate
aud.ts = ts(aud.df$Rate, frequency=12, start=c(1990,1))
plot(aud.ts, main="Monthly Average AUD to NZD Exchange Rate (Jan 1990 - March 2020)", 
xlab="Year",ylab="Monthly average exchange rate")
```

## Question 2 - Find a Stationary Time Series.
Found from: https://coinmarketcap.com/currencies/xrp/
```{r Change in XRP value}
#plot time vs change in xrp price 
#use all values apart from first row as wrong 
changeInXrp.ts = ts(xrp.df$Change.in.average.daily.price[2:367], frequency=365, start=c(2019,2))

plot(changeInXrp.ts, main="Change in daily average price of XRP from Jan 2019 to Jan 2020",
     xlab="Year", ylab="Change in XRP value (USD)")


```


## Question 3 - Find a Time Series that has a seasonal component but no trend or cycle.
Found from: http://www-eio.upc.edu/~pau/cms/rdata/datasets.html - called sunspot.month
```{r Sunspot Number}
#Mike: Seasonal component - every 10 year there is a peak
#plot time vs exchange rate
sunspot.ts = ts(sunspot.df$sunspot.month, frequency=12, start=c(1749,1))
plot(sunspot.ts, main="Monthly Sunspot Numbers (1749 to 2013)", 
xlab="Year", ylab="Sunspot Numbers")
```

## Question 3 - Find a Time Series that has a seasonal component but no trend or cycle.
Found from: https://www.kaggle.com/marvintherain/average-monthly-temp/data
```{r Mean Monthly Temperature}
#extract wuhan 
temp.df = temp.df[temp.df$City == 'Wuhan', c("dt", "AverageTemperature")]
rownames(temp.df) <- 1:nrow(temp.df) #reindex rows 
#extract 2000 onwards
temp.df = temp.df[1909:2072, c("dt", "AverageTemperature")]
rownames(temp.df) <- 1:nrow(temp.df) #reindex rows 
#add time axis
temp.df["Time"] = temp.df$dt

#plot time vs temp
temp.ts = ts(temp.df$AverageTemperature, frequency=12, start=c(2000,1))
plot(temp.ts, main="Monthly Temperature in Wuhan, China (2001 to 2013)", 
xlab="Year", ylab="Temperature (Celcius)")
```


## Question 4 - Find a Time Series that has a reasonably linear trend and has a seasonal component. 
Found from: https://new.censusatschool.org.nz/resource/time-series-data-sets-2013/
```{r NZ Alcohol Consumption}
#extract years 2002 to 2006
alc.ts = ts(alc.df$TotalWine[9:29], freq=4, start=c(2002,1))
plot(alc.ts, main="Quarterly Total Wine Consumption in New Zealand (2002 to 2007)", 
xlab="Year", ylab="Wine consumption (Litres)")
```
## Question 4 - Find a Time Series that has a reasonably linear trend and has a seasonal component. 
Found from: https://new.censusatschool.org.nz/resource/time-series-data-sets-2013/
```{r NZ Traverllers Purpose}
travellers.ts = ts(vis.df$Friends.Relatives, freq=12, start=c(2000,1))
plot(travellers.ts, main="Monthly Travellers coming to New Zealand with the purpose of seeing friends/family (2000 to 2013)", 
xlab="Year", ylab="Number of Travellers")
```

## Question 5  
```{r Cape Grim CO2 Concentration}

#load data
capeGrim.df = read.table("Data\\CapeGrim CO2 2000.1 - 2019.9.txt",header = TRUE, sep = "\t")

#plot time series from January 2000 to September 2019
capeGrim.ts = ts(capeGrim.df$CO2, freq=12, start=c(2000,1))
plot(capeGrim.ts, main="Average Monthly CO2 Concentration at Cape Grim (Jan 2000 to Sept 2019)", xlab="Year", ylab="CO2 Concentration")

#convert data into average concentration for each quarter from 2000 to 2019.3
capeGrimQuarterly.ts = aggregate(capeGrim.ts,  nfrequency = 4, FUN=mean)
#plot the quarterly series
plot(capeGrimQuarterly.ts, main="Average Quarterly CO2 Concentration at Cape Grim (Jan 2000 to Sept 2019)", xlab="Year", ylab="CO2 Concentration")

```