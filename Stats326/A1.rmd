---
title: "Stats 326 Assignment 1"
author: 'Name: Hasnain Cheena, ID:190411106'
output:
  word_document: default
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Read in data
```{r Data Sources}
aud.df = read.csv("Data/NZD To AUD.csv")
xrp.df = read.csv("Data/XRP Daily Price.csv")
temp.df = read.csv("Data/GlobalLandTemperaturesByMajorCity.csv")
alc.df = read.csv("Data/NZAlcoholConsumption.csv")
gold.df = read.csv("Data/Gold Prices.csv")
```

## Question 1 - Find a Time Series that exhibits cycles
```{r NZD AUD rate}
#plot time vs exchange rate
aud.ts = ts(aud.df$Rate, frequency=12, start=c(1990,1))
plot(aud.ts, main="Monthly Average AUD to NZD Exchange Rate (Jan 1990 - March 2020)", 
xlab="Year",ylab="Monthly average exchange rate")

#stl decomposition
plot(stl(aud.ts, s.window="periodic"))
```
The data was found from: https://www.ofx.com/en-us/forex-news/historical-exchange-rates/monthly-average-rates/
In the plot you can see major cycle accompanied by a few minor cycles. There is no seasonal component or clear trend.   
## Question 2 - Find a Stationary Time Series.
Found from: https://coinmarketcap.com/currencies/xrp/
```{r Change in XRP value}
#plot time vs change in xrp price 
#use all values apart from first row as wrong 
changeInXrp12.ts = ts(xrp.df$Change.in.average.daily.price[2:367], frequency=12, start=c(2019,2))
changeInXrp.ts = ts(xrp.df$Change.in.average.daily.price[2:367], frequency=365, start=c(2019,2))

plot(changeInXrp.ts, main="Change in daily average price of XRP from Jan 2019 to Jan 2020",
     xlab="Year", ylab="Change in XRP value (USD)")

plot(stl(changeInXrp12.ts, s.window="periodic"))
```

Data was found from: https://coinmarketcap.com/currencies/xrp/
The time series above shows no seasonality, trend or cycles. It is mean-centered at 0 and has reasonably constant variance. Thus it is a stationary time series. The large spikes in the plot indicate that there were large price fluctuations between June 2019 and August 2019.

## Question 2 - Find a Stationary Time Series.
Found from: https://www.gold.org/goldhub/data/gold-prices
```{r Gold prices}
gold.ts = ts(gold.df$Deviation[242:373], frequency=12, start=c(1990, 1))
plot(gold.ts, main="Deviations in the average monthly price of Gold (Jan 1990 to Dec 2000", ylab="USD", xlab="Time")

plot(stl(gold.ts, s.window = "period"))
```

Data was found from: https://www.gold.org/goldhub/data/gold-prices
The time series above shows no seasonality, trend or cycles. The plot displays that the time series is mean-centered at 0 and has reasonably constant variance. Thus it is a stationary time series and can be further classified as white noise. 

## Question 3 - Find a Time Series that has a seasonal component but no trend or cycle.
Found from: https://www.kaggle.com/marvintherain/average-monthly-temp/data
```{r Mean Monthly Temperature}
#extract wuhan 
temp.df = temp.df[temp.df$City == 'Wuhan', c("dt", "AverageTemperature")]
rownames(temp.df) <- 1:nrow(temp.df) #reindex rows 
#extract 2000 onwards
temp.df = temp.df[1909:2072, c("dt", "AverageTemperature")]
rownames(temp.df) <- 1:nrow(temp.df) #reindex rows 
#add time axis
temp.df["Time"] = temp.df$dt

#plot time vs temp
temp.ts = ts(temp.df$AverageTemperature, frequency=12, start=c(2000,1))
plot(temp.ts, main="Monthly Temperature in Wuhan, China (2001 to 2013)", 
xlab="Year", ylab="Temperature (Celcius)")

#stl decomposition
plot(stl(temp.ts, s.window="periodic"))

```
Data was found from: https://www.kaggle.com/marvintherain/average-monthly-temp/data
The data above shows a very strong seasonal component and has no trend or cycles present. 


## Question 4 - Find a Time Series that has a reasonably linear trend and has a seasonal component. 
Found from: https://new.censusatschool.org.nz/resource/time-series-data-sets-2013/
```{r NZ Alcohol Consumption}
#extract years 2002 to 2006
alc.ts = ts(alc.df$TotalWine[9:29], freq=4, start=c(2002,1))
plot(alc.ts, main="Quarterly Total Wine Consumption in New Zealand (2002 to 2007)", 
xlab="Year", ylab="Wine consumption (Litres)")

#stl decomposition
plot(stl(alc.ts, s.window="periodic"))
```
Data found from: Found from: https://new.censusatschool.org.nz/resource/time-series-data-sets-2013/
The plot above shows that the time series has a strong seasonal component and an increasing trend. Furthermore, the time series does not show any cyclical behaviour. 

## Question 5  
```{r Cape Grim CO2 Concentration}

#load data
capeGrim.df = read.table("Data\\CapeGrim CO2 2000.1 - 2019.9.txt",header = TRUE, sep = "\t")

#plot time series from January 2000 to September 2019
capeGrim.ts = ts(capeGrim.df$CO2, freq=12, start=c(2000,1))
plot(capeGrim.ts, main="Average Monthly CO2 Concentration at Cape Grim (Jan 2000 to Sept 2019)", xlab="Year", ylab="CO2 Concentration")

#convert data into average concentration for each quarter from 2000 to 2019.3
capeGrimQuarterly.ts = aggregate(capeGrim.ts,  nfrequency = 4, FUN=mean)
#plot the quarterly series
plot(capeGrimQuarterly.ts, main="Average Quarterly CO2 Concentration at Cape Grim (Jan 2000 to Sept 2019)", xlab="Year", ylab="CO2 Concentration")

#stl
plot(stl(capeGrimQuarterly.ts, s.window="periodic"))
```

The plot shows a clear increasing trend in CO2 concentration at Cape Grim. Further, the plot displays seasonal behaviour with a slight 'bump' in CO2 concentration approximately once a year. There is no cyclical behaviour. 